Big thanks to @jnm2 and @webczat in their help prototyping this library.